<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gizlilik ve Takip Politikası</title>
  <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f9f9f9;
      color: #222;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #2c3e50;
      color: white;
      padding: 20px;
      text-align: center;
    }

    .container {
      max-width: 900px;
      margin: 40px auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    h2 {
      color: #2c3e50;
      border-left: 5px solid #ffcc00;
      padding-left: 10px;
    }

    h3 {
      color: #34495e;
      margin-top: 30px;
    }

    ul {
      padding-left: 20px;
    }

    li {
      margin-bottom: 10px;
    }

    p {
      line-height: 1.7;
    }

    pre {
      background-color: #272822;
      color: #f8f8f2;
      padding: 20px;
      overflow-x: auto;
      border-radius: 10px;
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.9rem;
      margin-top: 40px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    footer {
      text-align: center;
      padding: 20px;
      background: #f1f1f1;
      color: #666;
      font-size: 0.9rem;
    }

    @media (max-width: 600px) {
      .container {
        margin: 20px;
        padding: 20px;
      }
    }
  </style>
</head>
<body>

  <header>
    <h1>Gizlilik Politikası</h1>
  </header>

  <div class="container">
    <h2>Veri Toplama ve Kullanımı</h2>
    <p>
      Bu web sitesi, kullanıcı deneyimini iyileştirmek ve topluluk faaliyetlerini analiz etmek amacıyla bazı veriler toplamaktadır.
    </p>

    <h3>Toplanan Veriler</h3>
    <ul>
      <li>Tarayıcı bilgileri (User Agent)</li>
      <li>Ziyaret edilen sayfalar</li>
      <li>Sayfada geçirilen süre</li>
      <li>Sayfadan çıkış zamanı</li>
      <li>Kullanıcının IP adresi (gizli tutulur)</li>
      <li>Kullanıcıların IP adresleri, olası güvenlik ihlallerinde tespit ve müdahale süreçlerinde kullanılmak üzere önleyici bir güvenlik tedbiri olarak kaydedilmektedir. Güvenlik ihlali durumlarında, ilgili kullanıcılar hakkında yasal işlemler başlatılabilir. Aynı güvenlik önlemleri, sistemimizde yer alan proxy sunucularımız ve arka uç (backend) sunucularımız için de geçerli olup, ilgili veriler bu katmanlarda da kayıt altına alınmakta ve korunmaktadır.</li>
  </ul>

    <h3>Verilerin Saklanma Süresi</h3>
    <p>
      Toplanan veriler Firebase üzerinden güvenli bir şekilde saklanmakta olup, maksimum 1 yıl süreyle tutulur. Bu sürenin sonunda anonimleştirilir veya kalıcı olarak silinir.
    </p>

    <h3>Veri Paylaşımı</h3>
    <p>
      Hiçbir kişisel veri üçüncü taraflarla paylaşılmaz. Tüm işlemler güvenli ve şeffaf şekilde yürütülür.
    </p>

    <h3>Kullanıcı Hakları</h3>
    <p>
      6698 sayılı Kişisel Verilerin Korunması Kanunu (KVKK) kapsamında, kullanıcılar diledikleri zaman verilerine erişme, sildirme veya düzelttirme hakkına sahiptir. İlgili talepler için lütfen bizimle iletişime geçin.
    </p>

    <h2>İzleme Kodu</h2>
    <p>
      Aşağıda, ziyaretçi davranışlarını analiz etmek için kullanılan JavaScript izleme kodu yer almaktadır. Şu anlık geliştirilme aşamasındadır:
    </p>

    <pre><code>
// Tam takip fonksiyonu (çerez kabul edildiğinde)
async function startTracking() {
  const ipAddress = await getIpAddress();

  sessionRef = await addDoc(collection(db, "siteSessions"), {
    sessionId: sessionId,
    startTime: serverTimestamp(),
    userAgent: navigator.userAgent,
    page: window.location.pathname,
    ipAddress: ipAddress,
    exited: false,
    consent: true
  });

  window.addEventListener("beforeunload", async () => {
    const endTime = new Date();
    const durationSeconds = Math.floor((endTime - startTime) / 1000);

    try {
      await updateDoc(sessionRef, {
        endTime: serverTimestamp(),
        durationSeconds: durationSeconds,
        exited: true
      });
    } catch (error) {
      console.error("Çıkış verisi güncellenemedi:", error);
    }
  });
}

// Minimal takip fonksiyonu (çerez reddedildiğinde)
async function trackMinimalSession() {
  const ipAddress = await getIpAddress();

  sessionRef = await addDoc(collection(db, "siteSessions"), {
    sessionId: sessionId,
    startTime: serverTimestamp(),
    ipAddress: ipAddress,
    consent: false,
    exited: false
  });

  window.addEventListener("beforeunload", async () => {
    try {
      await updateDoc(sessionRef, {
        endTime: serverTimestamp(),
        exited: true
      });
    } catch (error) {
      console.error("Minimal çıkış verisi güncellenemedi:", error);
    }
  });
}

window.acceptCookies = function() {
  if (cookieConsent !== null) return; // Zaten seçim yapılmışsa tekrar işlem yapma
  cookieConsent = true;
  document.getElementById('cookieBanner').style.display = 'none';
  startTracking();
}

window.rejectCookies = function() {
  if (cookieConsent !== null) return; // Zaten seçim yapılmışsa tekrar işlem yapma
  cookieConsent = false;
  document.getElementById('cookieBanner').style.display = 'none';
  console.log("Kullanıcı çerezleri reddetti, sadece IP verisi toplanıyor.");
  trackMinimalSession();
}

// Sayfa yüklendiğinde, 10 saniye içinde seçim yapılmazsa otomatik reddet
window.addEventListener('load', () => {
  setTimeout(() => {
    if (cookieConsent === null) {
      console.log("Kullanıcı seçim yapmadı, otomatik reddedildi.");
      window.rejectCookies();
    }
  }, 10000); // 10 saniye (10000 ms)
});
    </code></pre>
  </div>

  <footer>
    © 2025 Tüm hakları saklıdır.
  </footer>

</body>
</html>
